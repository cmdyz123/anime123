import{r as d,p as L,o as N,a as v,d as e,t as h,w as r,v as m,F as R,e as w,u as J,g as c}from"./vendor-BQIWbYX8.js";import{_ as O}from"./index-C5-_rSnE.js";const T={class:"month-editor"},B={key:0},j={class:"header-section"},D={class:"add-anime-form"},F={class:"form-group"},P={class:"form-group"},W={class:"form-group"},q={class:"anime-list-section"},x={key:0,class:"anime-edit"},z=["onUpdate:modelValue"],G=["onUpdate:modelValue"],H=["onUpdate:modelValue"],K={class:"edit-actions"},Q=["onClick"],X=["onClick"],Y={key:1,class:"anime-display"},Z=["src","alt"],ee={class:"anime-details"},te={class:"anime-actions"},le=["onClick"],oe=["onClick"],se={key:1},ae={__name:"MonthEditor",setup(ne){const g=J(),b=L(),y=d(localStorage.getItem("userRole")||"user"),u=d(b.params.month||"2025.10"),_=d(u.value.replace(".","年")+"月"),C=()=>{g.push({path:`/anime/${u.value}`})},$=()=>{g.push({name:"Restricted"})},M=()=>{g.push({name:"CategoryManager"})},l=d([]),a=d({title:"",info:"",image:""}),p=d(-1),k=d({}),V=()=>{const o=JSON.parse(localStorage.getItem(`animeList${u.value}`))||[];o.length>0?l.value=o:l.value=[{id:1,title:`${_.value} 新番1`,info:"(全12话) 大陆",image:`/images/${u.value}/default.jpg`},{id:2,title:`${_.value} 新番2`,info:"(全13话) 港台",image:`/images/${u.value}/default.jpg`}]},f=()=>{localStorage.setItem(`animeList${u.value}`,JSON.stringify(l.value))},U=()=>{if(a.value.title&&a.value.image){const o=Math.max(...l.value.map(s=>s.id),0)+1;let t=a.value.image;t.startsWith(`/images/${u.value}/`)||(t=`/images/${u.value}/${t}`),l.value.push({id:o,title:a.value.title,info:a.value.info,image:t}),f(),a.value={title:"",info:"",image:""},console.log("动漫添加成功")}else alert("请填写标题和图片路径")},S=o=>{p.value=o,k.value=JSON.parse(JSON.stringify(l.value[o]))},A=o=>{l.value[o].title&&l.value[o].image?(p.value=-1,f(),console.log("动漫信息更新成功")):alert("请填写标题和图片路径")},E=o=>{l.value[o]=k.value,p.value=-1},I=o=>{confirm("确定要删除这个动漫吗？")&&(l.value.splice(o,1),f(),console.log("动漫删除成功"))};return N(()=>{V()}),(o,t)=>(c(),v("div",T,[y.value==="admin"?(c(),v("div",B,[e("div",j,[e("h1",null,h(_.value)+" 动漫编辑器",1),e("div",{class:"nav-buttons"},[e("button",{class:"nav-btn",onClick:C},"返回月份页面"),e("button",{class:"nav-btn",onClick:M},"分类管理")])]),e("div",D,[t[6]||(t[6]=e("h2",null,"添加新动漫",-1)),e("div",F,[t[3]||(t[3]=e("label",null,"标题:",-1)),r(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>a.value.title=s),placeholder:"输入动漫标题"},null,512),[[m,a.value.title]])]),e("div",P,[t[4]||(t[4]=e("label",null,"信息:",-1)),r(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>a.value.info=s),placeholder:"输入动漫信息"},null,512),[[m,a.value.info]])]),e("div",W,[t[5]||(t[5]=e("label",null,"图片路径:",-1)),r(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=s=>a.value.image=s),placeholder:"输入图片路径"},null,512),[[m,a.value.image]])]),e("button",{class:"add-btn",onClick:U},"添加动漫")]),e("div",q,[t[7]||(t[7]=e("h2",null,"现有动漫",-1)),(c(!0),v(R,null,w(l.value,(s,n)=>(c(),v("div",{key:s.id,class:"anime-item"},[p.value===n?(c(),v("div",x,[r(e("input",{type:"text","onUpdate:modelValue":i=>l.value[n].title=i,class:"edit-input"},null,8,z),[[m,l.value[n].title]]),r(e("input",{type:"text","onUpdate:modelValue":i=>l.value[n].info=i,class:"edit-input"},null,8,G),[[m,l.value[n].info]]),r(e("input",{type:"text","onUpdate:modelValue":i=>l.value[n].image=i,class:"edit-input"},null,8,H),[[m,l.value[n].image]]),e("div",K,[e("button",{onClick:i=>A(n)},"保存",8,Q),e("button",{onClick:i=>E(n)},"取消",8,X)])])):(c(),v("div",Y,[e("img",{src:s.image,alt:s.title,class:"anime-thumbnail"},null,8,Z),e("div",ee,[e("h3",null,h(s.title),1),e("p",null,h(s.info),1)]),e("div",te,[e("button",{onClick:i=>S(n)},"编辑",8,le),e("button",{onClick:i=>I(n)},"删除",8,oe)])]))]))),128))])])):(c(),v("div",se,[e("div",{class:"restricted-access"},[t[8]||(t[8]=e("h1",null,"权限不足",-1)),t[9]||(t[9]=e("p",null,"您没有权限访问动漫编辑页面，请以管理员身份登录。",-1)),e("button",{class:"nav-btn",onClick:$},"返回")])]))]))}},de=O(ae,[["__scopeId","data-v-f15f5d15"]]);export{de as default};
